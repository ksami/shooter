<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>hello phaser!</title>
  </head>
  <body>
    <script src="/js/phaser.min.js"></script>
    <script type="text/javascript">
      window.onload = function() {

        const SPEED_MOVE_PLAYER = 400,
          RATE_FIRE_PLAYER = 200,
          SPEED_MOVE_LASER = 1000;

        var game = new Phaser.Game(800, 600, Phaser.AUTO, "", { preload: preload, create: create, update: update });
        var player,
          lasers,
          keys,
          timeNextFire = 0;

        function preload() {
          game.load.image("background", "assets/background.png");
          game.load.image("player", "assets/shooter.png");
          game.load.image("laser", "assets/laser.png");
        }

        function create() {
          //  Physics
          game.physics.startSystem(Phaser.Physics.ARCADE);
          game.physics.arcade.bounds = new Phaser.Rectangle(0, 108, game.world.width, game.world.height-216);

          // Background
          game.add.sprite(0, 0, "background");

          // Player
          player = game.add.sprite(0, game.world.height/2, "player");
          player.anchor.x = 0.5;
          player.anchor.y = 0.5;

          game.physics.arcade.enable(player);
          player.body.collideWorldBounds = true;

          // Lasers
          lasers = game.add.group();
          lasers.enableBody = true;
          lasers.physicsBodyType = Phaser.Physics.ARCADE;

          lasers.createMultiple(10, "laser", null, false);
          lasers.setAll("checkWorldBounds", true);
          lasers.setAll("outOfBoundsKill", true);

          // Input
          keys = game.input.keyboard.addKeys({
            "left": Phaser.KeyCode.A,
            "right": Phaser.KeyCode.D,
            "fire": Phaser.KeyCode.W
          });
        }

        function update() {
          //  Reset the players velocity (movement)
          player.body.velocity.y = 0;

          if (keys.left.isDown) {
            //  Move up
            player.body.velocity.y = -SPEED_MOVE_PLAYER;
          } else if (keys.right.isDown) {
            //  Move down
            player.body.velocity.y = SPEED_MOVE_PLAYER;
          }

          if (keys.fire.isDown) {
            if (game.time.now > timeNextFire && lasers.countDead() > 0) {
              timeNextFire = game.time.now + RATE_FIRE_PLAYER;
              var laser = lasers.getFirstDead();
              laser.reset(player.x, player.y);
              laser.body.velocity.x = SPEED_MOVE_LASER;
            }
          }
        }

      };
    </script>

  </body>
</html>